"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.QueuedTransport = void 0;
class QueuedTransport {
    constructor(
    /**
     * A function to be called any time a message needs to be written
     */
    writer) {
        this.messageQueue = [];
        this.setWriter(writer);
    }
    setWriter(writer) {
        this.writer = writer;
        if (typeof this.writer === 'function') {
            try {
                if (this.messageQueue.length > 0) {
                    for (const message of this.messageQueue) {
                        this.writer(message);
                    }
                }
            }
            finally {
                this.messageQueue = [];
            }
        }
    }
    pipe(message) {
        if (this.writer) {
            this.writer(message);
        }
        else {
            this.messageQueue.push(message);
        }
    }
}
exports.QueuedTransport = QueuedTransport;
//# sourceMappingURL=QueuedTransport.js.map